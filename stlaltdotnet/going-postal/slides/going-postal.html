<!doctype html>  
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Going Postal with postal.js</title>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/main.css">
		<link rel="stylesheet" href="lib/zenburn.css">
		<style type="text/css">
		pre {font-size:0.7em !important;}
		</style>
	</head>
	<body>
		
		<div id="reveal">
			<!-- Used to fade in a background when a specific slide state is reached -->
			<div class="state-background"></div>
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Going Postal</h1>
					<h2>with postal.js</h2>
					<h3>in five parts</h3>
				</section>

				<section>
					<h1>Part 1</h1>
					<h2>In which we compare DOM events</h2>
					<h3>to postal messages</h3>
				</section>

				<section>
					<h2>DOM events are interaction-oriented</h2>
					<pre><code>
$('#foo').on('click', function () {...});
$('#foo').on('hover', function () {...});
$('#foo').on('keydown', function () {...});
$('#foo').on('mouseover', function () {...});
$(document).on('load', function () {...});
$().ready(function () {...});
					</code></pre>
					<p><a href="http://en.wikipedia.org/wiki/DOM_events">'DOM Events', Wikipedia</a></p>
				</section>

				<section>
					<h2>jQuery supports user-defined events</h2>
					<pre><code>
&lt;div id="foo"&gt;&lt;button id="bar" /&gt;&lt;/div&gt;

&lt;script type="text/javascript"&gt;
$('#foo').on('launch', function () {
    launchAllMissiles();
});
$('#bar').trigger('launch');
&lt;/script&gt;
					</code></pre>
				</section>

				<section>
					<h2>But...</h2>
					<ul>
						<li class="fragment">DOM events only bubble UP the DOM tree</li>
						<li class="fragment">Since events can be triggered anywhere in the DOM tree, the best place to put listeners would be at the top of the tree (e.g. the `body` tag)</li>
						<li class="fragment">Only one callback can be assigned for a specific event on a given element</li>
					</ul>
				</section>

				<section>
					<h2>A common scenario</h2>
					<pre><code>
&lt;script type="text/javascript"&gt;
$('body').on('error-raised', function (evt, msg) {
  $('#error-message').html(msg).show();
});

//sometime later...
$.post('/my/url', data, function () {
  //yay our post worked!
}).error(function (){
  $(this).trigger('error-raised', ['bad!']);
});
&lt;/script&gt;
					</code></pre>
				</section>

				<section>
					<h2>Use postal.js instead</h2>
					<pre><code>
&lt;script type="text/javascript"&gt;
postal.subscribe('error-raised', function (msg) {
  $('#error-message').html(msg).show();
});


//sometime later...
$.post('/my/url', data, function () {
  //yay our post worked!
}).error(function (){
  postal.publish('error-raised', 'bad!');
});
&lt;/script&gt;
					</code></pre>
				</section>

				<section>
					<h1>Part 2</h1>
					<h2>In which we acknowledge that postal.js is great</h2>
					<h3>but your code is still a mess</h3>
					<h4>and you are grounded until you clean it up</h4>
				</section>

				<section>
					<h2>Organizing JavaScript code is challenging</h2>
					<ul>
						<li class="fragment">Encapsulate code to avoid global variable collisions</li>
						<li class="fragment">Deconstruct code and isolate reusable components</li>
						<li class="fragment">Organize script files for easy maintainability</li>
						<li class="fragment">Load script files in the correct order (satisfy dependencies)</li>
					</ul>
				</section>

				<section>
					<h2>Organizing JavaScript code is challenging</h2>
					<ul>
						<li class="fragment">Avoid jQuey spaghetti code</li>
						<li class="fragment">Avoid large trees of nested callbacks</li>
						<li class="fragment">Segregate UI code from application logic</li>
					</ul>
				</section>

				<section>
					<h2>Organizing code into modules</h2>
					<dl style="margin-top:1em;">
						<dt><strong>modÂ·ule [moj-ool]:</strong></dt>
						<dd style="margin-top:1em;">
							<p>Code that is encapsulated within a function closure that has a course, public API.</p>
						</dd>
					</dl>
				</section>

				<section>
					<h2>Organizing code into modules</h2>
					<pre><code>
//tax rate module
var taxRate = (function () {
  //"private" members
  var _rates = {
    'mo': 7.925
  };
  //public API
  return {
    calc: function (state, retail) {
      return _rates[state] * retail;
    }
  };
}());

var retail = 10.53;
var tax = taxRate.calc('mo', retail);
var total = retail + tax;
					</code></pre>
				</section>

				<section>
					<h2>Module communication using callbacks</h2>
					<pre><code>
var mod1 = (function () { ... }());
var mod2 = (function () { ... }());

//similar to .NET events
mod1.onSomeEvent(function () {
  mod2.doSomethingInResponse();
});
					</code></pre>
				</section>

				<section>
					<h2>Module communication using postal</h2>
					<pre><code>
var mod1 = (function ($, bus) {
  var $list = $('#items');
  bus.subscribe('new-items', function (items) {
    items.forEach(function (item) {
      $list.append($('&lt;li&gt;&lt;/li&gt;')
        .html(item));
    });
  });
}(jQuery, postal));

var mod2 = (function (bus) {
  bus.publish('new-items', ['foo', 'bar']);
}(postal));
					</code></pre>
				</section>

				<section>
					<h2>Better modules with require.js</h2>
					<ul>
						<li>Simple configuration tells require.js where to look for JavaScript files</li>
						<li>One script tag required on your page; require.js does the rest</li>
						<li>Resolves module dependencies (jQuery, postal, underscore, etc.)</li>
						<li>Lots of other awesome sauce!</li>
					</ul>
				</section>

				<section>
					<h1>Part 3</h1>
					<h2>In which we learn about</h2>
					<h3>advanced features in postal.js</h3>
				</section>

				<section>
					<h1>Part 4</h1>
					<h2>In which some actual code is shown</h2>
					<h3>and you are less bored</h3>
					<div>
						<img src="img/code-all-the-things.jpg" style="margin:auto; display:block;" />
					</div>
				</section>

				<section>
					<h1>Part 5</h1>
					<h2>In which I point you</h2>
					<h3>to additional resources</h3>
				</section>

				<section>
					<h2>Additional Resources</h2>
					<p>Client-side Messaging in JavaScript</p>
					<ul>
						<li><a href="http://bit.ly/IC8qqb">Part 1 http://bit.ly/IC8qqb</a></li>
						<li><a href="http://bit.ly/HDT9R9">Part 2 http://bit.ly/HDT9R9</a></li>
						<li><a href="http://bit.ly/Ip2RIw">Part 3 http://bit.ly/Ip2RIw</a></li>
					</ul>
				</section>

				<section>
					<h2>Additional Resources</h2>
					<p>Postal.js on Github</p>
					<p><a href="https://github.com/ifandelse/postal.js">https://github.com/ifandelse/postal.js</a></p>
				</section>

				<section>
					<h2>Additional Resources</h2>
					<p>jsFiddle examples</p>
					<p><a href="http://jsfiddle.net/ifandelse/NTPcT">http://jsfiddle.net/ifandelse/NTPcT</a></p>
				</section>

				<section>
					<h2>Additional Resources</h2>
					<p>Jim Cowart <a href="http://www.twitter.com/ifandelse">@ifandelse</a></p>
					<div>
						<img src="img/jim-cowart-twitter.png" style="display:block; margin:auto;" />
					</div>
				</section>
			</div>	

			<!-- The navigational controls UI -->
			<aside class="controls">
				<a class="left" href="#">&#x25C4;</a>
				<a class="right" href="#">&#x25BA;</a>
				<a class="up" href="#">&#x25B2;</a>
				<a class="down" href="#">&#x25BC;</a>
			</aside>

			<!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
			<div class="progress"><span></span></div>
		</div>
		
		<script src="js/reveal.js"></script>
		<!-- Optional libraries for code syntax highlighting and classList support in IE9 -->
		<script src="lib/highlight.js"></script>
		<script src="lib/classList.js"></script>
		<script>
			// Parse the query string into a key/value object
			var query = {};
			location.search.replace( /[A-Z0-9]+?=(\w*)/gi, function(a) {
				query[ a.split( '=' ).shift() ] = a.split( '=' ).pop();
			} );

			Reveal.initialize({
				// Display controls in the bottom right corner
				controls: true,

				// Display a presentation progress bar
				progress: true,

				// If true; each slide will be pushed to the browser history
				history: true,

				// Flags if mouse wheel navigation should be enabled
				mouseWheel: true,

				// Apply a 3D roll to links on hover
				rollingLinks: true,

				// UI style
				theme: query.theme || 'default', // default/neon

				// Transition style
				transition: query.transition || 'default' // default/cube/page/concave/linear(2d)
			});

			hljs.initHighlightingOnLoad();
		</script>
	</body>
</html>